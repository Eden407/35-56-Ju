def search_ios_app(app_name):
    import urllib.parse
    query = urllib.parse.quote(app_name)
    # Use iTunes Search API to get the app detail page URL
    search_url = f"https://itunes.apple.com/search?term={query}&entity=software"
    headers = {"User-Agent": "Mozilla/5.0"}
    try:
        response = requests.get(search_url, headers=headers, verify=False)
        response.raise_for_status()
    except Exception as e:
        print(f"{RED}[iOS] Error fetching search results: {e}{RESET}")
        return None

    data = response.json()
    results = data.get("results", [])
    if not results:
        print(f"{RED}[iOS] App '{app_name}' not found in search results.{RESET}")
        return None

    app_url = results[0].get("trackViewUrl")
    if not app_url:
        print(f"{RED}[iOS] App URL not found in search result.{RESET}")
        return None

    # Fetch the app's detail page
    try:
        response2 = requests.get(app_url, headers=headers, verify=False)
        response2.raise_for_status()
    except Exception as e:
        print(f"{RED}[iOS] Error fetching app details: {e}{RESET}")
        return None

    soup2 = BeautifulSoup(response2.text, "html.parser")

    # --- Extract Version Info ---
    version = None
    for li in soup2.find_all("li"):
        text = li.get_text(strip=True)
        if text.startswith("Version"):
            version = text.replace("Version", "").strip()
            break
    if not version:
        version_candidate = soup2.find(string=lambda t: t and "Version" in t)
        if version_candidate:
            version = version_candidate.split("Version")[-1].strip()
    if not version:
        version = "Version info not found"

    # --- Extract Release Notes ---
    release_notes = None

    # Attempt 1: Look for a section with aria-label "What's New"
    whats_new_section = soup2.find("section", attrs={"aria-label": "What's New"})
    if whats_new_section:
        # Sometimes the release notes are within a <p> tag inside this section
        p_elem = whats_new_section.find("p")
        if p_elem:
            release_notes = p_elem.get_text(separator="\n", strip=True)
        else:
            release_notes = whats_new_section.get_text(separator="\n", strip=True)

    # Attempt 2: Look for header tags containing "What's New" and then find the following element
    if not release_notes:
        header = soup2.find(lambda tag: tag.name in ["h2", "h3"] and "What's New" in tag.text)
        if header:
            next_elem = header.find_next_sibling()
            if next_elem:
                release_notes = next_elem.get_text(separator="\n", strip=True)

    # Final fallback if still not found
    if not release_notes:
        release_notes = "Release notes not found"

    print(f"\n{BLUE}[iOS]{RESET}")
    print(f"{GREEN}App URL:{RESET} {app_url}")
    print(f"{YELLOW}Version:{RESET} {version}")
    print(f"{YELLOW}Release Notes:{RESET}\n{release_notes}")
    return True
